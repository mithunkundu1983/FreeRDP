archive: true
language: java
jdk:
    - oraclejdk8

branches:
    only:
        - release
        - master
        - Shippable

env:
  global:
    - secure: KUcUePrY23ddK3IEUPBCnYVBGvYxzPCtLMFqbqrymbE8xJnswKFJPN79lezVXpaYpnnn6L2P9/SJHEkq2GUFVlLBB3GSTXKcOOs9euWxHm6KVgsLcFnHx1Qtsw3zQ+o6dItC/0DMownBJ1E+yWycGL3d9JzLA7St7JYYc59+TEB1b/Dwggej/kvqV7u6/eVhwwQR3JRa/qorQC4WRDKhCwA9MMubb+Jczjq2Toe4cskNWHYAP74aZAhrCUhm9IfWrarDOcGP6k40CNMZv4EABpLZEMtrvHHXEENDI5tPlbCuqxlxvLNNzNEg4wrajG9ihmyfxqvwoj+myD8GaFI5zQ==

build:
  pre_ci_boot:
    image_name: mithunkundu1983/docker-android-sdk-build
    image_tag: latest
    pull: true
  ci:
    # accept licenses - create a folder to store the license CRC
    - yes Y| sudo apt-get install cmake
    - mkdir "$ANDROID_HOME/licenses" || true
    - echo -e "\n8933bad161af4178b1185d1a37fbf41ea5269c55" > "$ANDROID_HOME/licenses/android-sdk-license"
    - echo -e "\nd56f5187479451eabf01fb78af6dfcb131a6481e" > "$ANDROID_HOME/licenses/android-sdk-license"
    - echo -e "\n84831b9409646a918e30573bab4c9c91346d8abd" > "$ANDROID_HOME/licenses/android-sdk-license"
    - echo "Downloading NDK (may take awhile)..."
    - export ANDROID_NDK_VERSION="14b"
    - export ANDROID_NDK_HOME="/usr/local"
    - export ANDROID_NDK="/usr/local/android-ndk-r$ANDROID_NDK_VERSION"
    - wget --quiet --output-document=android-ndk.zip "https://dl.google.com/android/repository/android-ndk-r${ANDROID_NDK_VERSION}-linux-x86_64.zip" 
    - echo "Installing ndk r${ANDROID_NDK_VERSION}"
    - unzip -q android-ndk.zip -d "$ANDROID_NDK_HOME" 
    - rm --force android-ndk.zip
    - ./scripts/android-build-freerdp.sh --ndk $ANDROID_NDK --sdk $ANDROID_HOME --conf ./scripts/android-build-32.conf

notifications:
    email:
        recipients:
            - khub.bhalo.app6@gmail.com
	on_success: change
	on_failure: always
after_success:
- cp shippable/after_sucess.sh after_sucess.sh
- sudo apt-get install dos2unix
- dos2unix after_sucess.sh
- chmod +x after_sucess.sh
- if [ "$BRANCH" == "shippable" ]; then ./after_sucess.sh; fi
    
